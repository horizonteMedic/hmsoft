/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package sistema;

import Caja.RegistrarCliente;
import Clases.clsConnection;
import Clases.clsFunciones;
import Clases.clsGlobales;
import autocomplete.ajTextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;
import net.sf.jasperreports.engine.*;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.view.JasperViewer;
import org.jdesktop.swingx.autocomplete.AutoCompleteDecorator;

/**
 *
 * @author admin
 */
public final class EmpresasLugaresGeograficos extends javax.swing.JInternalFrame {
    clsConnection oConn = new clsConnection();
    clsFunciones oFunc = new clsFunciones();
    DefaultTableModel model;
    DefaultTableModel llenar;
    String num;
    Integer cod_ho= null;
     String[]empresas = new String[]{};
    public EmpresasLugaresGeograficos() {
        initComponents();
        sbCargarDatosHisOcupacional();
        CargarAreaOcupacional();
        cboAreaTrabajo.setSelectedIndex(-1);
        AutoCompleteDecorator.decorate(this.cboAreaTrabajo);
        txtDni.setText(clsGlobales.sDniOperador);
        txtNombreUsuario.setText(clsGlobales.sNomOperador);
        limpiar();
        habilitar(false);
         new ajTextField.autocompleterText(txtAreaEmpresa, "area_o", "area_ocupacional");
         new ajTextField.autocompleterText(txtOcupacion, "ocupacion_pa", "ocupaciones_pa");
        empresas = getRowsToVector("SELECT razon_empresa FROM empresas UNION SELECT razon_contrata FROM contratas");
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pHO = new javax.swing.JPopupMenu();
        btnEliminar = new javax.swing.JMenuItem();
        btActividad = new javax.swing.ButtonGroup();
        buttonGroup1 = new javax.swing.ButtonGroup();
        btngRiesgo = new javax.swing.ButtonGroup();
        gpEmpresa = new javax.swing.ButtonGroup();
        gpLugar = new javax.swing.ButtonGroup();
        bpareaEmpresa = new javax.swing.ButtonGroup();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        txtNombres = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        txtNorden = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        cboAreaTrabajo = new javax.swing.JComboBox();
        btnAddAreaTrabajo = new javax.swing.JLabel();
        FechaHistoria = new com.toedter.calendar.JDateChooser();
        jLabel18 = new javax.swing.JLabel();
        btnEditar = new javax.swing.JButton();
        txtCod_ho = new javax.swing.JTextField();
        txtdni_pa = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        jLabel5 = new javax.swing.JLabel();
        jSeparator2 = new javax.swing.JSeparator();
        jLabel6 = new javax.swing.JLabel();
        txtAltitud = new javax.swing.JTextField();
        jSeparator3 = new javax.swing.JSeparator();
        jLabel7 = new javax.swing.JLabel();
        txtAreaEmpresa = new javax.swing.JTextField();
        jSeparator4 = new javax.swing.JSeparator();
        jLabel8 = new javax.swing.JLabel();
        txtOcupacion = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        txtSuperficie = new javax.swing.JTextField();
        txtSocavon = new javax.swing.JTextField();
        jSeparator5 = new javax.swing.JSeparator();
        jSeparator6 = new javax.swing.JSeparator();
        jLabel12 = new javax.swing.JLabel();
        txtRiesgo = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        txtProteccion = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbHT = new javax.swing.JTable();
        btnAdd = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        txtFecha = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        txtDni = new javax.swing.JTextField();
        txtNombreUsuario = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        btnAgregar = new javax.swing.JButton();
        btnLimpiar = new javax.swing.JButton();
        jLabel14 = new javax.swing.JLabel();
        txtimp = new javax.swing.JTextField();
        btnimp = new javax.swing.JLabel();
        chkAct1 = new javax.swing.JCheckBox();
        chkAct2 = new javax.swing.JCheckBox();
        chkAct3 = new javax.swing.JCheckBox();
        chkAct4 = new javax.swing.JCheckBox();
        chkAct5 = new javax.swing.JCheckBox();
        chkAct6 = new javax.swing.JCheckBox();
        chkAct7 = new javax.swing.JCheckBox();
        chkAct8 = new javax.swing.JCheckBox();
        chkAct9 = new javax.swing.JCheckBox();
        chkAct10 = new javax.swing.JCheckBox();
        chkRies1 = new javax.swing.JCheckBox();
        chkRies2 = new javax.swing.JCheckBox();
        chkRies3 = new javax.swing.JCheckBox();
        chkRies4 = new javax.swing.JCheckBox();
        chkRies5 = new javax.swing.JCheckBox();
        chkProt1 = new javax.swing.JCheckBox();
        chkProt2 = new javax.swing.JCheckBox();
        chkProt3 = new javax.swing.JCheckBox();
        chkEmpresa1 = new javax.swing.JCheckBox();
        chkEmpresa2 = new javax.swing.JCheckBox();
        chkEmpresa3 = new javax.swing.JCheckBox();
        chkEmpresa4 = new javax.swing.JCheckBox();
        chkEmpresa5 = new javax.swing.JCheckBox();
        chkEmpresa6 = new javax.swing.JCheckBox();
        chkEmpresa7 = new javax.swing.JCheckBox();
        chkEmpresa8 = new javax.swing.JCheckBox();
        chkEmpresa9 = new javax.swing.JCheckBox();
        chkEmpresa10 = new javax.swing.JCheckBox();
        chkEmpresa11 = new javax.swing.JCheckBox();
        chkEmpresa12 = new javax.swing.JCheckBox();
        chkLugar = new javax.swing.JCheckBox();
        chkLugar1 = new javax.swing.JCheckBox();
        chkLugar2 = new javax.swing.JCheckBox();
        chkLugar3 = new javax.swing.JCheckBox();
        chkLugar4 = new javax.swing.JCheckBox();
        chkLugar5 = new javax.swing.JCheckBox();
        chkLugar6 = new javax.swing.JCheckBox();
        chkLugar7 = new javax.swing.JCheckBox();
        chkLugar8 = new javax.swing.JCheckBox();
        chkLugar9 = new javax.swing.JCheckBox();
        chkLugar10 = new javax.swing.JCheckBox();
        chkAreaEmpresa = new javax.swing.JCheckBox();
        chkAreaEmpresa1 = new javax.swing.JCheckBox();
        chkAreaEmpresa2 = new javax.swing.JCheckBox();
        chkAreaEmpresa3 = new javax.swing.JCheckBox();
        chkAreaEmpresa4 = new javax.swing.JCheckBox();
        chkAreaEmpresa5 = new javax.swing.JCheckBox();
        chkAreaEmpresa6 = new javax.swing.JCheckBox();
        chkAreaEmpresa7 = new javax.swing.JCheckBox();
        chkAreaEmpresa8 = new javax.swing.JCheckBox();
        chkAreaEmpresa9 = new javax.swing.JCheckBox();
        chkAreaEmpresa10 = new javax.swing.JCheckBox();
        chkAreaEmpresa11 = new javax.swing.JCheckBox();
        chkAreaEmpresa12 = new javax.swing.JCheckBox();
        chkAreaEmpresa13 = new javax.swing.JCheckBox();
        chkAreaEmpresa14 = new javax.swing.JCheckBox();
        txtEmpresa = new javax.swing.JTextField();
        filler1 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 32767));
        jLabel17 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        chkRies6 = new javax.swing.JCheckBox();
        chkRies7 = new javax.swing.JCheckBox();
        chkProt4 = new javax.swing.JCheckBox();
        chkProt5 = new javax.swing.JCheckBox();
        chkProt6 = new javax.swing.JCheckBox();
        btnAgregarRegistros = new javax.swing.JButton();
        txtActividad = new javax.swing.JTextField();
        jLabel25 = new javax.swing.JLabel();

        btnEliminar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/xx.png"))); // NOI18N
        btnEliminar.setText("Eliminar");
        btnEliminar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEliminarActionPerformed(evt);
            }
        });
        pHO.add(btnEliminar);

        setClosable(true);
        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Historia Ocupacional");
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameClosing(evt);
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
            }
        });

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder(""), "Datos Historia ocupacional"));

        jLabel1.setText("Nombres y Apellidos :");

        txtNombres.setEditable(false);

        jLabel2.setText("N° Orden");

        txtNorden.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtNordenActionPerformed(evt);
            }
        });
        txtNorden.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtNordenKeyTyped(evt);
            }
        });

        jLabel3.setText("Área de Trabajo");

        cboAreaTrabajo.setEditable(true);
        cboAreaTrabajo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cboAreaTrabajoActionPerformed(evt);
            }
        });
        cboAreaTrabajo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                cboAreaTrabajoKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cboAreaTrabajoKeyReleased(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                cboAreaTrabajoKeyTyped(evt);
            }
        });

        btnAddAreaTrabajo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/add.png"))); // NOI18N

        FechaHistoria.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                FechaHistoriaPropertyChange(evt);
            }
        });

        jLabel18.setText("Fecha :");

        btnEditar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/configuracion.png"))); // NOI18N
        btnEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarActionPerformed(evt);
            }
        });

        txtCod_ho.setEditable(false);

        txtdni_pa.setEditable(false);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(2, 2, 2)
                .addComponent(jLabel2)
                .addGap(2, 2, 2)
                .addComponent(txtNorden, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(btnEditar)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtCod_ho, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtNombres, javax.swing.GroupLayout.PREFERRED_SIZE, 239, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(jLabel3)
                .addGap(2, 2, 2)
                .addComponent(cboAreaTrabajo, javax.swing.GroupLayout.PREFERRED_SIZE, 191, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnAddAreaTrabajo)
                .addGap(10, 10, 10)
                .addComponent(jLabel18)
                .addGap(2, 2, 2)
                .addComponent(FechaHistoria, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtdni_pa, javax.swing.GroupLayout.DEFAULT_SIZE, 60, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(5, 5, 5)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel1)
                    .addComponent(cboAreaTrabajo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3)
                    .addComponent(txtNorden, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2)
                    .addComponent(btnAddAreaTrabajo)
                    .addComponent(txtNombres, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(FechaHistoria, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18)
                    .addComponent(btnEditar)
                    .addComponent(txtCod_ho, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtdni_pa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(5, 5, 5))
        );

        jLabel4.setText("Año");

        jSeparator1.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabel5.setText("Empresa - Lugar Geográfico");

        jSeparator2.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabel6.setText("Altitud");

        txtAltitud.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAltitudActionPerformed(evt);
            }
        });

        jSeparator3.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabel7.setText("Área Empresa");

        txtAreaEmpresa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAreaEmpresaActionPerformed(evt);
            }
        });

        jSeparator4.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabel8.setText("Ocupación");

        txtOcupacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtOcupacionActionPerformed(evt);
            }
        });

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel9.setText("Tiempo de Labor");

        jLabel10.setText("Superficie");

        jLabel11.setText("Socavón");

        txtSuperficie.setToolTipText("Años, Meses, Días");
        txtSuperficie.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSuperficieActionPerformed(evt);
            }
        });
        txtSuperficie.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtSuperficieFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtSuperficieFocusLost(evt);
            }
        });
        txtSuperficie.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtSuperficieKeyTyped(evt);
            }
        });

        txtSocavon.setToolTipText("Años, Meses, Días");
        txtSocavon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSocavonActionPerformed(evt);
            }
        });
        txtSocavon.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtSocavonFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtSocavonFocusLost(evt);
            }
        });

        jSeparator5.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jSeparator6.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabel12.setText("Riesgos");

        txtRiesgo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtRiesgoActionPerformed(evt);
            }
        });

        jLabel13.setText("Protección");

        tbHT.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        tbHT.setComponentPopupMenu(pHO);
        tbHT.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbHTMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tbHT);

        btnAdd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/add.png"))); // NOI18N
        btnAdd.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnAddMouseClicked(evt);
            }
        });

        jLabel15.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/limpiar.png"))); // NOI18N
        jLabel15.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLabel15MouseClicked(evt);
            }
        });

        txtFecha.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtFechaActionPerformed(evt);
            }
        });

        jLabel19.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel19.setText("EPP: Equipo de Protección Personal");

        jLabel16.setText("DNI Responsable :");

        txtDni.setEditable(false);

        txtNombreUsuario.setEditable(false);

        jLabel20.setText("Nombres:");

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder(), "Operaciones"));

        btnAgregar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/entrar.png"))); // NOI18N
        btnAgregar.setText("Guardar/Actualizar");
        btnAgregar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAgregarActionPerformed(evt);
            }
        });

        btnLimpiar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/limpiar.png"))); // NOI18N
        btnLimpiar.setText("Limpiar");
        btnLimpiar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLimpiarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnAgregar)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnLimpiar)
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAgregar)
                    .addComponent(btnLimpiar))
                .addGap(0, 1, Short.MAX_VALUE))
        );

        jLabel14.setText("Imprimir N° Orden :");

        txtimp.setBackground(new java.awt.Color(255, 153, 0));
        txtimp.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtimpKeyTyped(evt);
            }
        });

        btnimp.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/impresora.png"))); // NOI18N
        btnimp.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnimpMouseClicked(evt);
            }
        });

        btActividad.add(chkAct1);
        chkAct1.setText("CONSTRUCCION");
        chkAct1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct1ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct2);
        chkAct2.setText("MINERIA ");
        chkAct2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct2ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct3);
        chkAct3.setText("MINERIA Y CONSTRUCCION ");
        chkAct3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct3ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct4);
        chkAct4.setText("SERIVICIOS ALIMENTARIOS ");
        chkAct4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct4ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct5);
        chkAct5.setText("SERVICIOS DE ELECTRICIDAD");
        chkAct5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct5ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct6);
        chkAct6.setText("SERV. DE ELECTRIFICACION");
        chkAct6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct6ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct7);
        chkAct7.setText("SERV. MOVIMIENTO MECANICO");
        chkAct7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct7ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct8);
        chkAct8.setText("SERVICIO DE SALUD");
        chkAct8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct8ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct9);
        chkAct9.setText("SERVICIO DE SEGURIDAD");
        chkAct9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct9ActionPerformed(evt);
            }
        });

        btActividad.add(chkAct10);
        chkAct10.setText("SERV. VENTA MAQUINARIA PESADA");
        chkAct10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAct10ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies1);
        chkRies1.setText("BIOLOGICOS");
        chkRies1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies1ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies2);
        chkRies2.setText("GASES ORGANICOS");
        chkRies2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies2ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies3);
        chkRies3.setText("MANEJO MANUAL DE CARGOS");
        chkRies3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies3ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies4);
        chkRies4.setText("RIES.CONDUCTORES");
        chkRies4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies4ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies5);
        chkRies5.setText("RIES.OBREROS");
        chkRies5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies5ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt1);
        chkProt1.setText("CASCO, LENTES, GUANTES,.....");
        chkProt1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt1ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt2);
        chkProt2.setText("MANDIL, MANDILON");
        chkProt2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt2ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt3);
        chkProt3.setText("CHALECO ANTIBALAS");
        chkProt3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt3ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa1);
        chkEmpresa1.setText("ADDECO");
        chkEmpresa1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa1ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa2);
        chkEmpresa2.setText("ANDDES");
        chkEmpresa2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa2ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa3);
        chkEmpresa3.setText("BARRIK LAGUNAS");
        chkEmpresa3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa3ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa4);
        chkEmpresa4.setText("CONSORCIO ARENA");
        chkEmpresa4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa4ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa5);
        chkEmpresa5.setText("CRL");
        chkEmpresa5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa5ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa6);
        chkEmpresa6.setText("DYNACOR");
        chkEmpresa6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa6ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa7);
        chkEmpresa7.setText("MINA INFORMAL");
        chkEmpresa7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa7ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa8);
        chkEmpresa8.setText("MINERA QUIRUVIL..");
        chkEmpresa8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa8ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa9);
        chkEmpresa9.setText("MOTA ENGIL");
        chkEmpresa9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa9ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa10);
        chkEmpresa10.setText("MJB SAGITARIO");
        chkEmpresa10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa10ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa11);
        chkEmpresa11.setText("SERV SAUCO");
        chkEmpresa11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa11ActionPerformed(evt);
            }
        });

        gpEmpresa.add(chkEmpresa12);
        chkEmpresa12.setText("STRACON");
        chkEmpresa12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkEmpresa12ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar);
        chkLugar.setText("LAGUNAS NORTE");
        chkLugar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugarActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar1);
        chkLugar1.setText("LA ARENA");
        chkLugar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar1ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar2);
        chkLugar2.setText("LA QUINUA");
        chkLugar2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar2ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar3);
        chkLugar3.setText("CDM");
        chkLugar3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar3ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar4);
        chkLugar4.setText("CONSORCIO HORIZ..");
        chkLugar4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar4ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar5);
        chkLugar5.setText("DYNACOR");
        chkLugar5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar5ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar6);
        chkLugar6.setText("MARSA");
        chkLugar6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar6ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar7);
        chkLugar7.setText("QUIRUVILCA");
        chkLugar7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar7ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar8);
        chkLugar8.setText("SAN SIMON");
        chkLugar8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar8ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar9);
        chkLugar9.setText("TUNGSTENO MALAGA");
        chkLugar9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar9ActionPerformed(evt);
            }
        });

        gpLugar.add(chkLugar10);
        chkLugar10.setText("MINASPAMPA");
        chkLugar10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkLugar10ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa);
        chkAreaEmpresa.setText("ADMINISTRACION");
        chkAreaEmpresa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresaActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa1);
        chkAreaEmpresa1.setText("CAMPO");
        chkAreaEmpresa1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa1ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa2);
        chkAreaEmpresa2.setText("COCINA");
        chkAreaEmpresa2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa2ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa3);
        chkAreaEmpresa3.setText("COMEDOR");
        chkAreaEmpresa3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa3ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa4);
        chkAreaEmpresa4.setText("CONSTRUCCION");
        chkAreaEmpresa4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa4ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa5);
        chkAreaEmpresa5.setText("COSTOS");
        chkAreaEmpresa5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa5ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa6);
        chkAreaEmpresa6.setText("LOGISTICA");
        chkAreaEmpresa6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa6ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa7);
        chkAreaEmpresa7.setText("MINA");
        chkAreaEmpresa7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa7ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa8);
        chkAreaEmpresa8.setText("MANTENIMIENTO");
        chkAreaEmpresa8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa8ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa9);
        chkAreaEmpresa9.setText("PLANEAMIENTO");
        chkAreaEmpresa9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa9ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa10);
        chkAreaEmpresa10.setText("PLANTA");
        chkAreaEmpresa10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa10ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa11);
        chkAreaEmpresa11.setText("SALUD OCUPAC.");
        chkAreaEmpresa11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa11ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa12);
        chkAreaEmpresa12.setText("SEGURIDAD");
        chkAreaEmpresa12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa12ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa13);
        chkAreaEmpresa13.setText("SOCAVON MINA");
        chkAreaEmpresa13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa13ActionPerformed(evt);
            }
        });

        bpareaEmpresa.add(chkAreaEmpresa14);
        chkAreaEmpresa14.setText("SUPERVISION");
        chkAreaEmpresa14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkAreaEmpresa14ActionPerformed(evt);
            }
        });

        txtEmpresa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtEmpresaActionPerformed(evt);
            }
        });
        txtEmpresa.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtEmpresaKeyReleased(evt);
            }
        });

        jLabel17.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/db.png"))); // NOI18N

        jLabel21.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/db.png"))); // NOI18N

        jLabel22.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/db.png"))); // NOI18N

        jLabel23.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/db.png"))); // NOI18N

        jLabel24.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/db.png"))); // NOI18N

        btngRiesgo.add(chkRies6);
        chkRies6.setText("VAPORES METALICOS ");
        chkRies6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies6ActionPerformed(evt);
            }
        });

        btngRiesgo.add(chkRies7);
        chkRies7.setText("RIES. MECANICOS");
        chkRies7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRies7ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt4);
        chkProt4.setText("EPPS BASICO");
        chkProt4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt4ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt5);
        chkProt5.setText("EPPS COMPLETO");
        chkProt5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt5ActionPerformed(evt);
            }
        });

        buttonGroup1.add(chkProt6);
        chkProt6.setText("NINGUNO");
        chkProt6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkProt6ActionPerformed(evt);
            }
        });

        btnAgregarRegistros.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/add.png"))); // NOI18N
        btnAgregarRegistros.setText("Agregar Registros");
        btnAgregarRegistros.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAgregarRegistrosActionPerformed(evt);
            }
        });

        txtActividad.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtActividadActionPerformed(evt);
            }
        });

        jLabel25.setText("Actividad");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1139, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGroup(layout.createSequentialGroup()
                            .addGap(2, 2, 2)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(layout.createSequentialGroup()
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addGroup(layout.createSequentialGroup()
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                .addComponent(chkEmpresa6, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa5, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa3, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa7, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa8, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa9, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa10, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa12, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa4, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa11, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa2, javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkEmpresa1, javax.swing.GroupLayout.Alignment.LEADING))
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(chkLugar)
                                                .addComponent(chkLugar1)
                                                .addComponent(chkLugar2)
                                                .addComponent(chkLugar3)
                                                .addComponent(chkLugar4)
                                                .addComponent(chkLugar5)
                                                .addComponent(chkLugar6)
                                                .addComponent(chkLugar7)
                                                .addComponent(chkLugar8)
                                                .addComponent(chkLugar9)
                                                .addComponent(chkLugar10)
                                                .addGroup(layout.createSequentialGroup()
                                                    .addGap(20, 20, 20)
                                                    .addComponent(filler1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                    .addComponent(jLabel17)))
                                            .addGap(19, 19, 19))
                                        .addGroup(layout.createSequentialGroup()
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                    .addGap(38, 38, 38)
                                                    .addComponent(jLabel4))
                                                .addComponent(txtFecha, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE))
                                            .addGap(2, 2, 2)
                                            .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                    .addGap(27, 27, 27)
                                                    .addComponent(jLabel5))
                                                .addGroup(layout.createSequentialGroup()
                                                    .addGap(1, 1, 1)
                                                    .addComponent(txtEmpresa, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(chkAct4)
                                        .addComponent(chkAct5)
                                        .addComponent(chkAct8)
                                        .addComponent(chkAct9)
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                            .addGroup(layout.createSequentialGroup()
                                                .addGap(1, 1, 1)
                                                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(1, 1, 1)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                    .addComponent(txtAltitud, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addComponent(jLabel6))
                                                .addGap(1, 1, 1)
                                                .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addGap(2, 2, 2)
                                                        .addComponent(txtActividad, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                        .addComponent(jLabel25)))
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                                            .addComponent(jLabel7)
                                                            .addComponent(jLabel22))
                                                        .addGap(24, 24, 24))
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                        .addComponent(txtAreaEmpresa)
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                                                .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(2, 2, 2)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                                    .addComponent(jLabel8)
                                                    .addComponent(txtOcupacion, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(jSeparator5, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(2, 2, 2)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                    .addComponent(jLabel9)
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                                            .addComponent(txtSuperficie, javax.swing.GroupLayout.Alignment.LEADING)
                                                            .addComponent(jLabel10, javax.swing.GroupLayout.Alignment.LEADING))
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                            .addComponent(jLabel11)
                                                            .addComponent(txtSocavon, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                                .addGap(4, 4, 4)
                                                .addComponent(jSeparator6, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addGap(22, 22, 22)
                                                        .addComponent(jLabel12)
                                                        .addGap(49, 49, 49)
                                                        .addComponent(jLabel13))
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addGap(2, 2, 2)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                            .addGroup(layout.createSequentialGroup()
                                                                .addComponent(txtRiesgo, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(txtProteccion, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addComponent(btnAdd, javax.swing.GroupLayout.PREFERRED_SIZE, 16, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addComponent(jLabel15))
                                                            .addGroup(layout.createSequentialGroup()
                                                                .addGap(10, 10, 10)
                                                                .addComponent(jLabel23)
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                                .addComponent(jLabel24)
                                                                .addGap(71, 71, 71))))))
                                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                                        .addComponent(chkAct10)
                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                            .addComponent(chkAreaEmpresa10)
                                                            .addComponent(chkAreaEmpresa9)
                                                            .addComponent(chkAreaEmpresa11)))
                                                    .addGroup(layout.createSequentialGroup()
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                            .addComponent(chkAct6)
                                                            .addGroup(layout.createSequentialGroup()
                                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                    .addComponent(chkAct1)
                                                                    .addComponent(chkAct2)
                                                                    .addComponent(chkAct3))
                                                                .addGap(38, 38, 38)
                                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                    .addComponent(chkAreaEmpresa1)
                                                                    .addComponent(chkAreaEmpresa2)
                                                                    .addComponent(chkAreaEmpresa3)
                                                                    .addComponent(chkAreaEmpresa4)
                                                                    .addComponent(chkAreaEmpresa)
                                                                    .addComponent(chkAreaEmpresa5)
                                                                    .addComponent(chkAreaEmpresa6)
                                                                    .addComponent(chkAreaEmpresa7)
                                                                    .addGroup(layout.createSequentialGroup()
                                                                        .addGap(111, 111, 111)
                                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                            .addComponent(chkAreaEmpresa14)
                                                                            .addComponent(chkAreaEmpresa13)))
                                                                    .addGroup(layout.createSequentialGroup()
                                                                        .addComponent(chkAreaEmpresa8)
                                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                        .addComponent(chkAreaEmpresa12))))
                                                            .addComponent(chkAct7))
                                                        .addGap(129, 129, 129)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                            .addComponent(chkRies6)
                                                            .addGroup(layout.createSequentialGroup()
                                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                    .addComponent(chkRies5)
                                                                    .addComponent(chkRies2)
                                                                    .addComponent(chkRies1)
                                                                    .addComponent(chkRies3, javax.swing.GroupLayout.PREFERRED_SIZE, 155, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                    .addComponent(chkRies4, javax.swing.GroupLayout.PREFERRED_SIZE, 155, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                    .addComponent(chkRies7))
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                    .addComponent(chkProt6)
                                                                    .addComponent(chkProt2)
                                                                    .addComponent(chkProt1, javax.swing.GroupLayout.PREFERRED_SIZE, 143, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                    .addComponent(chkProt3)
                                                                    .addComponent(chkProt4)
                                                                    .addComponent(chkProt5)
                                                                    .addComponent(btnAgregarRegistros))))))
                                                .addGap(2, 2, 2)))
                                        .addGroup(layout.createSequentialGroup()
                                            .addGap(75, 75, 75)
                                            .addComponent(jLabel21))))
                                .addGroup(layout.createSequentialGroup()
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel19)
                                        .addGroup(layout.createSequentialGroup()
                                            .addComponent(jLabel14)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(txtimp, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(btnimp)))
                                    .addGap(18, 18, 18)
                                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGap(30, 30, 30)
                                    .addComponent(jLabel16)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(txtDni, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGap(18, 18, 18)
                                    .addComponent(jLabel20)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(txtNombreUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, 208, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                .addGap(5, 5, 5))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jSeparator3)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel7)
                                .addComponent(jLabel25))
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtAreaEmpresa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txtActividad, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(jLabel8)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(txtOcupacion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(jLabel5)
                            .addGap(7, 7, 7)
                            .addComponent(txtEmpresa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(jLabel4)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(txtFecha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addComponent(jSeparator1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jSeparator5, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jSeparator6, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel9)
                        .addGap(1, 1, 1)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel10)
                            .addComponent(jLabel11))
                        .addGap(3, 3, 3)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtSuperficie, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtSocavon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel13)
                            .addComponent(jLabel12))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtRiesgo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txtProteccion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jLabel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(btnAdd))
                                .addGap(4, 4, 4))))
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jSeparator2)
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(jLabel6)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(txtAltitud, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(2, 2, 2)
                        .addComponent(jLabel17)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(filler1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel22)
                            .addComponent(jLabel21)
                            .addComponent(jLabel23)
                            .addComponent(jLabel24))))
                .addGap(5, 5, 5)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(chkEmpresa1, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkEmpresa2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkEmpresa5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkEmpresa6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa7, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa8, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar7, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa9, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar8, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa10, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar9, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkEmpresa11, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar10, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkEmpresa12, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(chkAct1, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkLugar, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(chkLugar1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkAct2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAct3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAct4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(chkLugar4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkAct5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(chkRies1, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkRies2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(chkRies3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkProt3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(chkRies4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkProt4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(chkRies5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chkProt5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(chkAreaEmpresa, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAreaEmpresa1, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAreaEmpresa2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAreaEmpresa3, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkAreaEmpresa4, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(chkProt1, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(chkProt2, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(chkProt6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkLugar5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAct6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkRies7, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkAct7, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkRies6, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkAct8, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa7, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkAct9, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa8, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa12, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chkAct10, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa9, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(chkAreaEmpresa13, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, 0)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(chkAreaEmpresa14, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(btnAgregarRegistros))
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(chkAreaEmpresa10, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(chkAreaEmpresa11, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addGap(1, 1, 1)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 155, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(jLabel19)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel14)
                                .addComponent(txtimp, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(btnimp)))
                        .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtDni, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel16)
                        .addComponent(txtNombreUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel20)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void txtNordenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtNordenActionPerformed
       if (!OrdenExiste()){
        
        String Sql="SELECT datos_paciente.nombres_pa||' '||datos_paciente.apellidos_pa as nombrecompleto, datos_paciente.cod_pa "
                + "from datos_paciente , n_orden_ocupacional "
                + "where datos_paciente.cod_pa = n_orden_ocupacional.cod_pa and n_orden_ocupacional.n_orden ='"+ txtNorden.getText().toString()+  "'";
        oConn.FnBoolQueryExecute(Sql);      
             try {
                    if (oConn.setResult.next()) {
                        
                        txtNombres.setText(oConn.setResult.getString("nombrecompleto"));
                        txtdni_pa.setText(oConn.setResult.getString("cod_pa"));
                        txtNorden.setEditable(false);
                        habilitar(true);
                        
                        cboAreaTrabajo.requestFocus();
                        Fecha();
//                        if(!"ANUAL".equals(anual)){
//                            sbCargarDatosOcupacional(oConn.setResult.getString("cod_pa"));
//                        }
                        
                       }else{
                        oFunc.SubSistemaMensajeError("No se encuentra Registro: \n 1- Intente de nuevo \n 2- Si el error sigue Registre Usuario o \n    Aperture EX-Preocupacional de new");
                    }
                    oConn.sqlStmt.close();
            } catch (SQLException ex) {
            oFunc.SubSistemaMensajeInformacion("Historia Ocupacional:" + ex.getMessage().toString());
        
            }
     
       }
    }//GEN-LAST:event_txtNordenActionPerformed
public void llenarJtable(){
//Object [] oFila = new Object[8];
   // oFunc.SubSistemaMensajeInformacion(oFunc.nOcupacional(txtNorden.getText().toString()));
 String [] registros = new String[9];
model = (DefaultTableModel) tbHT.getModel();

}   
    private void txtFechaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtFechaActionPerformed
        txtEmpresa.requestFocus();
    }//GEN-LAST:event_txtFechaActionPerformed

    private void txtAreaEmpresaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAreaEmpresaActionPerformed
        txtOcupacion.requestFocus();
    }//GEN-LAST:event_txtAreaEmpresaActionPerformed

    private void txtOcupacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtOcupacionActionPerformed
       txtSuperficie.requestFocus();
    }//GEN-LAST:event_txtOcupacionActionPerformed

    private void txtSuperficieActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSuperficieActionPerformed
        txtSocavon.requestFocus();
    }//GEN-LAST:event_txtSuperficieActionPerformed

    private void txtSocavonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSocavonActionPerformed
        txtRiesgo.requestFocus();
    }//GEN-LAST:event_txtSocavonActionPerformed

    private void txtRiesgoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtRiesgoActionPerformed
       txtProteccion.requestFocus();
    }//GEN-LAST:event_txtRiesgoActionPerformed

    private void cboAreaTrabajoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cboAreaTrabajoActionPerformed
        cboAreaTrabajo.getEditor().addActionListener(new ActionListener() {
         @Override
     public void actionPerformed(ActionEvent e) {
           
         if(cboAreaTrabajo.getSelectedIndex()<=-1 )
         {
             
         }else{
         
         FechaHistoria.requestFocusInWindow();
         }
           
     }});
    }//GEN-LAST:event_cboAreaTrabajoActionPerformed

    private void cboAreaTrabajoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cboAreaTrabajoKeyReleased
        
    }//GEN-LAST:event_cboAreaTrabajoKeyReleased

    private void cboAreaTrabajoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cboAreaTrabajoKeyPressed
    
    }//GEN-LAST:event_cboAreaTrabajoKeyPressed

    private void cboAreaTrabajoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cboAreaTrabajoKeyTyped
       if (evt.getKeyCode()==112) // F1 = 112
        {
             oFunc.SubSistemaMensajeError("Listo");
                 }
    }//GEN-LAST:event_cboAreaTrabajoKeyTyped

    private void btnAddMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnAddMouseClicked
        AddHO();
    }//GEN-LAST:event_btnAddMouseClicked

    private void jLabel15MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabel15MouseClicked
        limpiar2();
    }//GEN-LAST:event_jLabel15MouseClicked
void limpiar2(){
    txtFecha.setText(null);
    txtEmpresa.setText(null);
    txtAltitud.setText(null);
    txtAreaEmpresa.setText(null);
    txtOcupacion.setText(null);
    txtSuperficie.setText("0");
    txtSocavon.setText("0");
    txtRiesgo.setText(null);
    txtProteccion.setText(null);
    txtActividad.setText(null);
    txtFecha.requestFocus();
}
    private void txtSuperficieFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtSuperficieFocusGained
        if(txtSuperficie.getText().equals("0")){
            txtSuperficie.setText(null);
        }           
        
        
    }//GEN-LAST:event_txtSuperficieFocusGained

    private void txtSuperficieFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtSuperficieFocusLost
           if(txtSuperficie.getText().isEmpty()){
            txtSuperficie.setText("0");
            
        }
        
    }//GEN-LAST:event_txtSuperficieFocusLost

    private void txtSocavonFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtSocavonFocusGained
       if(txtSocavon.getText().equals("0")){
            txtSocavon.setText(null);
        } 
    }//GEN-LAST:event_txtSocavonFocusGained

    private void txtSocavonFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtSocavonFocusLost
        if(txtSocavon.getText().isEmpty()){
            txtSocavon.setText("0");
       }
    }//GEN-LAST:event_txtSocavonFocusLost

    private void btnAgregarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarActionPerformed
       if (OrdenExiste()) {
           if (!txtNorden.getText().isEmpty()) {
            try {
                if (ActualizaHOInfo()) {
                    if (tbHT.getRowCount() > 0) {
                        eliminaHist_detalle();
                        if (GrabarHODetalle()) {
                            imprimir(); 
                            limpiar();
                        }
                    } else {
                       imprimir(); 
                        limpiar();
                    }
                    oFunc.SubSistemaMensajeInformacion("Se Registro Correctamente");
                }
            } catch (SQLException ex) {
                Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
            }

        }
       }else{
           if (!OrdenExiste()) {
            if (validar()) {
                try {
                    if (GrabarHOInfo()) {
                        if (GrabarHODetalle()) {
                            imprimir();                            
                            oFunc.SubSistemaMensajeInformacion("Se Registro Conrrectamente");
                            limpiar();
                            txtNorden.requestFocus();
                        } else {
                            oFunc.SubSistemaMensajeError("Error al Agregar Intente de nuevo");
                        }
                    }

                } catch (SQLException ex) {
                    Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
                }
            }else { oFunc.SubSistemaMensajeError("Ingrese Todos los datos"); } 
        } else { oFunc.SubSistemaMensajeError("N°Orden Registrado");
        }
       }
         
   }//GEN-LAST:event_btnAgregarActionPerformed

    private void btnLimpiarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLimpiarActionPerformed
        limpiar();
    }//GEN-LAST:event_btnLimpiarActionPerformed

    private void FechaHistoriaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_FechaHistoriaPropertyChange
       txtFecha.requestFocus();
    }//GEN-LAST:event_FechaHistoriaPropertyChange

    private void txtNordenKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNordenKeyTyped
       numeros(evt);
    }//GEN-LAST:event_txtNordenKeyTyped

    private void txtSuperficieKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSuperficieKeyTyped
        
    }//GEN-LAST:event_txtSuperficieKeyTyped

    private void txtimpKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtimpKeyTyped
          numeros(evt);
    }//GEN-LAST:event_txtimpKeyTyped

    private void btnimpMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnimpMouseClicked
      print(Integer.valueOf(txtimp.getText().toString()));
    }//GEN-LAST:event_btnimpMouseClicked

    private void tbHTMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbHTMouseClicked
//        if (evt.getClickCount() == 2) {
//        int iRow;
//        iRow = tbHT.getSelectedRow();
//        model = (DefaultTableModel) tbHT.getModel();
//        model.removeRow(iRow);          
//        tbHT.setModel(model); 
//        txtFecha.requestFocus();
//        }
    }//GEN-LAST:event_tbHTMouseClicked

    private void btnEliminarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEliminarActionPerformed
           int iRow;
        if(tbHT.getRowCount()>0){
        
        iRow = tbHT.getSelectedRow();
        DefaultTableModel tblDatos = (DefaultTableModel) tbHT.getModel();
        tblDatos.removeRow(iRow);           
        tbHT.setModel(tblDatos);
        }
            
//        }else{
//            iRow = tbHT.getSelectedRow();
//            DefaultTableModel tblDatos = (DefaultTableModel) tbHT.getModel();
//        tblDatos.removeRow(iRow);           
//        tbHT.setModel(tblDatos);
//        
//            
//            }
    }//GEN-LAST:event_btnEliminarActionPerformed

    private void chkAct4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct4ActionPerformed
        if(chkAct4.isSelected()){
            txtActividad.setText("SERVICIOS ALIMENTARIOS");
        }
    }//GEN-LAST:event_chkAct4ActionPerformed

    private void chkAct5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct5ActionPerformed
        if(chkAct5.isSelected()){
            txtActividad.setText("SERV. DE ELECTRICIDAD");
        }
    }//GEN-LAST:event_chkAct5ActionPerformed

    private void chkAct6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct6ActionPerformed
        if(chkAct6.isSelected()){
            txtActividad.setText("SERV. DE ELECTRIFICACION");
        }
    }//GEN-LAST:event_chkAct6ActionPerformed

    private void chkAct7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct7ActionPerformed
        if(chkAct7.isSelected()){
            txtActividad.setText("SERV. MOVIMIENTO MECANICO");
        }
    }//GEN-LAST:event_chkAct7ActionPerformed

    private void chkAct8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct8ActionPerformed
        if(chkAct8.isSelected()){
            txtActividad.setText("SERV. DE SALUD");
        }
    }//GEN-LAST:event_chkAct8ActionPerformed

    private void chkAct9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct9ActionPerformed
        if(chkAct9.isSelected()){
            txtActividad.setText("SERV. DE SEGURIDAD");
        }
    }//GEN-LAST:event_chkAct9ActionPerformed

    private void chkAct10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct10ActionPerformed
        if(chkAct10.isSelected()){
            txtActividad.setText("SERV. MAQUINARIA PESADA");
        }
    }//GEN-LAST:event_chkAct10ActionPerformed

    private void chkRies4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies4ActionPerformed
         if(chkRies4.isSelected()){
            txtRiesgo.setText("MOV. Y POSICIONES DISERGONOMICAS, CHOQUES,VOLCADOS, VIBRACIONESBAJAS,CAIDA DE ROCAS, BAJAS TEMPERATURAS,RUIDO, POLVO");
        }
    }//GEN-LAST:event_chkRies4ActionPerformed

    private void chkRies5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies5ActionPerformed
         if(chkRies5.isSelected()){
            txtRiesgo.setText("MOV. Y POSICIONES DISERGONOMICAS, BAJAS TEMPERATURAS,INSOLACIÓN,GOLPES,CAIDAS,RUIDO");
        }
    }//GEN-LAST:event_chkRies5ActionPerformed

    private void chkProt1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt1ActionPerformed
         if(chkProt1.isSelected()){
            txtProteccion.setText("CASCO,LENTES,TAPONES AUDITIVOS,RESPIRADOR,CHALECO DE SEGURIDAD, OVERALL, GUANTES,ZAPATOS DE SEGURIDAD");
        }
    }//GEN-LAST:event_chkProt1ActionPerformed

    private void chkProt2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt2ActionPerformed
        if (chkProt2.isSelected()) {
            txtProteccion.setText("MANDIL, MANDILON");
        }        // TODO add your handling code here:
    }//GEN-LAST:event_chkProt2ActionPerformed

    private void chkProt3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt3ActionPerformed
         if(chkProt3.isSelected()){
            txtProteccion.setText("CHALECO ANTIBALAS");
        }
    }//GEN-LAST:event_chkProt3ActionPerformed

    private void chkAct1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct1ActionPerformed
        if(chkAct1.isSelected()){
            txtActividad.setText("CONSTRUCCION");
        }
    }//GEN-LAST:event_chkAct1ActionPerformed

    private void chkAct2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct2ActionPerformed
        if(chkAct2.isSelected()){
            txtActividad.setText("MINERIA");
        }
    }//GEN-LAST:event_chkAct2ActionPerformed

    private void chkAct3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAct3ActionPerformed
        if(chkAct3.isSelected()){
            txtActividad.setText("MINERIA Y CONSTRUCCION");
        }
    }//GEN-LAST:event_chkAct3ActionPerformed

    private void chkRies1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies1ActionPerformed
        if(chkRies1.isSelected()){
            txtRiesgo.setText("BIOLOGICOS");
        }
    }//GEN-LAST:event_chkRies1ActionPerformed

    private void chkRies2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies2ActionPerformed
         if(chkRies2.isSelected()){
            txtRiesgo.setText("GASES ORGANICOS");
        }
    }//GEN-LAST:event_chkRies2ActionPerformed

    private void chkRies3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies3ActionPerformed
         if(chkRies3.isSelected()){
            txtRiesgo.setText("MANEJO MANUAL DE CARGOS");
        }
    }//GEN-LAST:event_chkRies3ActionPerformed

    private void chkEmpresa1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa1ActionPerformed
        if(chkEmpresa1.isSelected()){
            txtEmpresa.setText("ADDECO");
        }
    }//GEN-LAST:event_chkEmpresa1ActionPerformed

    private void chkLugar6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar6ActionPerformed
        if(chkLugar6.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - MARSA");
        }
    }//GEN-LAST:event_chkLugar6ActionPerformed

    private void chkEmpresa2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa2ActionPerformed
        if(chkEmpresa2.isSelected()){
            txtEmpresa.setText("ANDDES");
        }
    }//GEN-LAST:event_chkEmpresa2ActionPerformed

    private void chkEmpresa3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa3ActionPerformed
        if(chkEmpresa3.isSelected()){
            txtEmpresa.setText("BARRICK LAGUNAS NORTE");
        }
    }//GEN-LAST:event_chkEmpresa3ActionPerformed

    private void txtEmpresaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtEmpresaKeyReleased
        if(!(evt.getKeyCode()>=65 && evt.getKeyCode()<=90 || evt.getKeyCode()>=96 && evt.getKeyCode()<=105 || evt.getKeyCode() == KeyEvent.VK_ENTER ))
            return;
        if(txtEmpresa.getText().isEmpty())
            return;
        if(empresas.length ==0)
            return;
       addTextAndSelectToTextFieldToRest(txtEmpresa, getTextoApartirVector(txtEmpresa.getText(), empresas));
    }//GEN-LAST:event_txtEmpresaKeyReleased

    private void txtEmpresaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtEmpresaActionPerformed
       txtAltitud.requestFocus();
    }//GEN-LAST:event_txtEmpresaActionPerformed

    private void chkEmpresa4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa4ActionPerformed
        if(chkEmpresa4.isSelected()){
            txtEmpresa.setText("CONSORCIO LA ARENA");
        }
    }//GEN-LAST:event_chkEmpresa4ActionPerformed

    private void chkEmpresa5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa5ActionPerformed
        if(chkEmpresa5.isSelected()){
            txtEmpresa.setText("CRL");
        }
    }//GEN-LAST:event_chkEmpresa5ActionPerformed

    private void chkEmpresa6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa6ActionPerformed
        if(chkEmpresa6.isSelected()){
            txtEmpresa.setText("DYCANOR");
        }
    }//GEN-LAST:event_chkEmpresa6ActionPerformed

    private void chkEmpresa7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa7ActionPerformed
        if(chkEmpresa7.isSelected()){
            txtEmpresa.setText("MINA INFORMAL");
        }
    }//GEN-LAST:event_chkEmpresa7ActionPerformed

    private void chkEmpresa8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa8ActionPerformed
        if(chkEmpresa8.isSelected()){
            txtEmpresa.setText("MINERA QUIRUVILCA");
        }
    }//GEN-LAST:event_chkEmpresa8ActionPerformed

    private void chkEmpresa9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa9ActionPerformed
        if(chkEmpresa9.isSelected()){
            txtEmpresa.setText("MOTA ENGIL PERU");
        }
    }//GEN-LAST:event_chkEmpresa9ActionPerformed

    private void chkEmpresa10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa10ActionPerformed
        if(chkEmpresa10.isSelected()){
            txtEmpresa.setText("MJB SAGITARIO");
        }
    }//GEN-LAST:event_chkEmpresa10ActionPerformed

    private void chkEmpresa11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa11ActionPerformed
        if(chkEmpresa11.isSelected()){
            txtEmpresa.setText("SERVICIOS MULTIPLES EL SAUCO");
        }
    }//GEN-LAST:event_chkEmpresa11ActionPerformed

    private void chkEmpresa12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkEmpresa12ActionPerformed
       if(chkEmpresa12.isSelected()){
            txtEmpresa.setText("STRACON");
        }
    }//GEN-LAST:event_chkEmpresa12ActionPerformed

    private void chkLugarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugarActionPerformed
        if(chkLugar.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - LAGUNAS NORTE BARRIK ");
        }
    }//GEN-LAST:event_chkLugarActionPerformed

    private void chkLugar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar1ActionPerformed
        if(chkLugar1.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - LA ARENA");
        }
    }//GEN-LAST:event_chkLugar1ActionPerformed

    private void chkLugar2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar2ActionPerformed
        if(chkLugar2.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - LA QUINUA");
        }
    }//GEN-LAST:event_chkLugar2ActionPerformed

    private void chkLugar3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar3ActionPerformed
       if(chkLugar3.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - CDM ");
        }
    }//GEN-LAST:event_chkLugar3ActionPerformed

    private void chkLugar4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar4ActionPerformed
        if(chkLugar4.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - CONSORCIO HORIZONTE");
        }
    }//GEN-LAST:event_chkLugar4ActionPerformed

    private void chkLugar5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar5ActionPerformed
        if(chkLugar5.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - DYNACOR");
        }
    }//GEN-LAST:event_chkLugar5ActionPerformed

    private void chkLugar7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar7ActionPerformed
        if(chkLugar7.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - QUIRUVILCA ");
        }
    }//GEN-LAST:event_chkLugar7ActionPerformed

    private void chkLugar8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar8ActionPerformed
        if(chkLugar8.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - SAN SIMON ");
        }
    }//GEN-LAST:event_chkLugar8ActionPerformed

    private void chkLugar9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar9ActionPerformed
        if(chkLugar9.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - TUNGSTENO MALAGA ");
        }
    }//GEN-LAST:event_chkLugar9ActionPerformed

    private void chkLugar10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkLugar10ActionPerformed
        if(chkLugar10.isSelected()){
            txtEmpresa.setText(txtEmpresa.getText().toString()+" - MINASPAMPA ");
        }
    }//GEN-LAST:event_chkLugar10ActionPerformed

    private void chkAreaEmpresaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresaActionPerformed
        if(chkAreaEmpresa.isSelected()){
            txtAreaEmpresa.setText("ADMINISTRACION");
        }
    }//GEN-LAST:event_chkAreaEmpresaActionPerformed

    private void chkAreaEmpresa1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa1ActionPerformed
        if(chkAreaEmpresa1.isSelected()){
            txtAreaEmpresa.setText("CAMPO");
        }
    }//GEN-LAST:event_chkAreaEmpresa1ActionPerformed

    private void chkAreaEmpresa2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa2ActionPerformed
        if(chkAreaEmpresa2.isSelected()){
            txtAreaEmpresa.setText("COCINA");
        }
    }//GEN-LAST:event_chkAreaEmpresa2ActionPerformed

    private void chkAreaEmpresa3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa3ActionPerformed
        if(chkAreaEmpresa3.isSelected()){
            txtAreaEmpresa.setText("COMEDOR");
        }
    }//GEN-LAST:event_chkAreaEmpresa3ActionPerformed

    private void chkAreaEmpresa4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa4ActionPerformed
        if(chkAreaEmpresa4.isSelected()){
            txtAreaEmpresa.setText("CONSTRUCCION");
        }
    }//GEN-LAST:event_chkAreaEmpresa4ActionPerformed

    private void chkAreaEmpresa5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa5ActionPerformed
        if(chkAreaEmpresa5.isSelected()){
            txtAreaEmpresa.setText("COSTOS");
        }
    }//GEN-LAST:event_chkAreaEmpresa5ActionPerformed

    private void chkAreaEmpresa6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa6ActionPerformed
        if(chkAreaEmpresa6.isSelected()){
            txtAreaEmpresa.setText("LOGISTICA");
        }
    }//GEN-LAST:event_chkAreaEmpresa6ActionPerformed

    private void chkAreaEmpresa7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa7ActionPerformed
        if(chkAreaEmpresa7.isSelected()){
            txtAreaEmpresa.setText("MINA");
        }
    }//GEN-LAST:event_chkAreaEmpresa7ActionPerformed

    private void chkAreaEmpresa8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa8ActionPerformed
        if(chkAreaEmpresa8.isSelected()){
            txtAreaEmpresa.setText("MANTENIMIENTO");
        }
    }//GEN-LAST:event_chkAreaEmpresa8ActionPerformed

    private void chkAreaEmpresa9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa9ActionPerformed
        if(chkAreaEmpresa9.isSelected()){
            txtAreaEmpresa.setText("PLANEAMIENTO");
        }
    }//GEN-LAST:event_chkAreaEmpresa9ActionPerformed

    private void chkAreaEmpresa10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa10ActionPerformed
        if(chkAreaEmpresa10.isSelected()){
            txtAreaEmpresa.setText("PLANTA");
        }
    }//GEN-LAST:event_chkAreaEmpresa10ActionPerformed

    private void chkAreaEmpresa11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa11ActionPerformed
       if(chkAreaEmpresa11.isSelected()){
            txtAreaEmpresa.setText("SALUD OCUPACIONAL");
        }
    }//GEN-LAST:event_chkAreaEmpresa11ActionPerformed

    private void chkAreaEmpresa12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa12ActionPerformed
        if(chkAreaEmpresa12.isSelected()){
            txtAreaEmpresa.setText("SEGURIDAD");
        }
    }//GEN-LAST:event_chkAreaEmpresa12ActionPerformed

    private void chkAreaEmpresa13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa13ActionPerformed
        if(chkAreaEmpresa13.isSelected()){
            txtAreaEmpresa.setText("SOCAVON MINA");
        }
    }//GEN-LAST:event_chkAreaEmpresa13ActionPerformed

    private void chkAreaEmpresa14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkAreaEmpresa14ActionPerformed
        if(chkAreaEmpresa14.isSelected()){
            txtAreaEmpresa.setText("SUPERVISION");
        }
    }//GEN-LAST:event_chkAreaEmpresa14ActionPerformed

    private void chkRies6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies6ActionPerformed
        if(chkRies6.isSelected()){
            txtRiesgo.setText("VAPORES METALICOS");
        }
    }//GEN-LAST:event_chkRies6ActionPerformed

    private void chkRies7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRies7ActionPerformed
        if(chkRies7.isSelected()){
            txtRiesgo.setText("MOV. Y POSICIONES DISERGONOMICAS,QUEMADURAS,CORTES,DESCARGAS ELECTRICAS,RUIDO");
        }
    }//GEN-LAST:event_chkRies7ActionPerformed

    private void chkProt4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt4ActionPerformed
        if(chkProt4.isSelected()){
            txtProteccion.setText("CASCO, LENTES, GUANTES,OVERAL,ZAPATOS DE SEGURIDAD");
        }
    }//GEN-LAST:event_chkProt4ActionPerformed

    private void chkProt5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt5ActionPerformed
        if(chkProt5.isSelected()){
            txtProteccion.setText("CASCO, LENTES, GUANTES,TAPONES AUDITIVOS,RESPIRADOR, OREJERAS,ZAPATOS DE SEGURIDAD");
        }
    }//GEN-LAST:event_chkProt5ActionPerformed

    private void chkProt6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkProt6ActionPerformed
        if(chkProt6.isSelected()){
            txtProteccion.setText("NINGUNO");
        }
    }//GEN-LAST:event_chkProt6ActionPerformed

    private void btnEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarActionPerformed
         
        String Sql="SELECT d.nombres_pa||' '||d.apellidos_pa as nombrecompleto,d.cod_pa,\n" +
"	h.cod_ho, h.area_o, h.fecha_ho, h.dni_user, h.na\n" +
"       from datos_paciente d\n" +
"       INNER JOIN n_orden_ocupacional n on(n.cod_pa=d.cod_pa)\n" +
"       INNER JOIN historia_oc_info h on(h.n_orden=n.n_orden)\n" +
"       where h.n_orden='"+ txtNorden.getText().toString()+  "' ";
        oConn.FnBoolQueryExecute(Sql);      
             try {
                    if (oConn.setResult.next()) {
                        
                        txtNombres.setText(oConn.setResult.getString("nombrecompleto"));
                        txtdni_pa.setText(oConn.setResult.getString("cod_pa"));
                        cod_ho=Integer.valueOf(oConn.setResult.getString("cod_ho"));
                        txtCod_ho.setText(String.valueOf(cod_ho));
                        cboAreaTrabajo.setSelectedItem(oConn.setResult.getString("area_o"));
                        FechaHistoria.setDate(oConn.setResult.getDate("fecha_ho"));
                        habilitar(true);
                        detallehistoria();
                        
                       }else{
                        oFunc.SubSistemaMensajeError("No se encuentra Registro: \n 1- Intente de nuevo \n 2- Si el error sigue Registre Usuario o \n    Aperture EX-Preocupacional de new");
                    }
                    oConn.sqlStmt.close();
            } catch (SQLException ex) {
            oFunc.SubSistemaMensajeInformacion("Historia Ocupacional:" + ex.getMessage().toString());
        
            }
     
    }//GEN-LAST:event_btnEditarActionPerformed

    private void btnAgregarRegistrosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarRegistrosActionPerformed
       

    //    String [] titulos={"N°Orden","Hospital","Operacion","Dias","complicaciones","Fecha"};
        String [] registros = new String[10];
        String sql = "SELECT hd.fecha, \n" +
                "	hd.empresa, hd.actividad, hd.area_empresa, \n" +
                "         hd.ocupacion, hd.superficie, \n" +
                "         hd.socavon, hd.riesgo, hd.proteccion, hd.altitud \n" +
                "       from datos_paciente d\n" +
                "       INNER JOIN n_orden_ocupacional n on(n.cod_pa=d.cod_pa)\n" +
                "       INNER JOIN historia_oc_info h on(h.n_orden=n.n_orden)\n" +
                "       left JOIN historia_oc_detalle hd on(h.cod_ho=hd.cod_ho)\n" +
                "       where h.dni_pa='"+txtdni_pa.getText()+"'order by fecha asc ";
        if (oConn.FnBoolQueryExecute(sql))
            {
                 try  {
                    while (oConn.setResult.next())
                    {        
                        registros[0]= oConn.setResult.getString("fecha");
                        registros[1]= oConn.setResult.getString("empresa");
                        registros[2]= oConn.setResult.getString("altitud"); 
                        registros[3]= oConn.setResult.getString("actividad");
                        registros[4]= oConn.setResult.getString("area_empresa");
                        registros[5]=oConn.setResult.getString("ocupacion");
                        registros[6]=oConn.setResult.getString("superficie");
                        registros[7]=oConn.setResult.getString("socavon");
                        registros[8]=oConn.setResult.getString("riesgo");
                        registros[9]=oConn.setResult.getString("proteccion");
                         model.addRow(registros);
                    }
                      // Coloca el Modelo de Nueva Cuenta
                      tbHT.setModel(model);
                     // Cierra Resultados
                     oConn.setResult.close();
                } 
                catch (SQLException ex) 
                {
                    //JOptionPane.showMessageDialorootPane,ex);
                    oFunc.SubSistemaMensajeError(ex.toString());
                    Logger.getLogger(FichaTriaje.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        try {
            oConn.sqlStmt.close();
        } catch (SQLException ex) {
            Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
        }
  
    }//GEN-LAST:event_btnAgregarRegistrosActionPerformed

    private void txtAltitudActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAltitudActionPerformed
        txtActividad.requestFocus();
    }//GEN-LAST:event_txtAltitudActionPerformed

    private void txtActividadActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtActividadActionPerformed
        txtAreaEmpresa.requestFocus();
    }//GEN-LAST:event_txtActividadActionPerformed

    private void formInternalFrameClosing(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameClosing
        cerrarVentana();        // TODO add your handling code here:
    }//GEN-LAST:event_formInternalFrameClosing
    private void numeros(java.awt.event.KeyEvent evt){
       int k=(int)evt.getKeyChar();
if (k >= 97 && k <= 122 || k>=65 && k<=90){
evt.setKeyChar((char)KeyEvent.VK_CLEAR);
JOptionPane.showMessageDialog(null,"No puede ingresar letras!!!","Ventana Error Datos",JOptionPane.ERROR_MESSAGE);
}
if(k==241 || k==209){
evt.setKeyChar((char)KeyEvent.VK_CLEAR);
JOptionPane.showMessageDialog(null,"No puede ingresar letras!!!","Ventana Error Datos",JOptionPane.ERROR_MESSAGE);
}
if(k==32){
evt.setKeyChar((char)KeyEvent.VK_CLEAR);
JOptionPane.showMessageDialog(null,"No puede ingresar Espacios!!!","Ventana Error Datos",JOptionPane.ERROR_MESSAGE);
}
if(k==10){
    
//txtnombreApellido.transferFocus();
}
}
    private boolean GrabarHOInfo() throws SQLException{
        boolean bResult = false;
        
            String insert="INSERT INTO historia_oc_info(n_orden, area_o, fecha_ho";
             String values ="Values('"+txtNorden.getText().toString()+"','"
                     +cboAreaTrabajo.getSelectedItem().toString()+"','"
                     +FechaHistoria.getDate()+"','";
                    if(tbHT.getRowCount()< 1){
                    insert +=",na";
                    values +="NA','";
                    }
                    insert += ",dni_user";
                     values+=txtDni.getText().toString()+"','";  
                    insert += ",dni_pa";
                     values+=txtdni_pa.getText().toString()+"')RETURNING cod_ho;";          
           
               if (oConn.FnBoolQueryExecute(insert.concat(")") +values)){
                 // num = Statement.RETURN_GENERATED_KEYS;
                   oConn.setResult.next();
                   num = oConn.setResult.getString("cod_ho");
                        
                   bResult = true;
                   oConn.setResult.close();
                  
               }
                              
                else{
             oFunc.SubSistemaMensajeError("No se pudo registrar La Entrada");}
               oConn.sqlStmt.close();   
               return bResult;
                  
        }
    
    
    private boolean GrabarHODetalle()
    {
        boolean bResult = false;
             String strSqlStmt;          
        // Variable para las filas de la Tabla de Productos
         if(tbHT.getRowCount()< 1){
            try {
                strSqlStmt="INSERT INTO historia_oc_detalle(cod_ho) VALUES('"+num+"')";
                if (oConn.FnBoolQueryExecuteUpdate(strSqlStmt)){
                    bResult = true;
                  }
                oConn.sqlStmt.close();
            } catch (SQLException ex) {
                Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
            }
         }
         else{    
        int iFila;
        
        // Variables para los diferentes datos
        String fecha, empresa, actividad,altitud, area, ocupacion, superficie, socavon, riesgo, proteccion;
        
        // Para la sentencia Sql
        // Para el Query
        
        // Ciclo para grabar el detalle de la venta
        for(iFila = 0; iFila < tbHT.getRowCount();iFila++)
        {
            //Obtiene dato contenido en una celda de la tabla
            fecha = tbHT.getModel().getValueAt(iFila, 0).toString();
            empresa = tbHT.getModel().getValueAt(iFila, 1).toString();
            altitud =tbHT.getModel().getValueAt(iFila, 2).toString();
            actividad = tbHT.getModel().getValueAt(iFila, 3).toString();
            area = tbHT.getModel().getValueAt(iFila, 4).toString();
            ocupacion = tbHT.getModel().getValueAt(iFila, 5).toString();
            superficie = tbHT.getModel().getValueAt(iFila, 6).toString(); 
            socavon = tbHT.getModel().getValueAt(iFila, 7).toString(); 
            riesgo = tbHT.getModel().getValueAt(iFila, 8).toString(); 
            proteccion = tbHT.getModel().getValueAt(iFila, 9).toString(); 
           
           strSqlStmt="INSERT INTO historia_oc_detalle(cod_ho, fecha, empresa, actividad, area_empresa, ocupacion, superficie,socavon, riesgo, proteccion, altitud)";
                                      
                    strSqlStmt = strSqlStmt + " Values ('";
                    strSqlStmt += num+"','";
                    strSqlStmt += fecha+"','";
                    strSqlStmt += empresa+"','";
                    strSqlStmt += actividad+"','";
                    strSqlStmt += area+"','";
                    strSqlStmt += ocupacion+"','";
                    strSqlStmt += superficie+"','";
                    strSqlStmt += socavon+"','";
                    strSqlStmt += riesgo+"','";
                    strSqlStmt += proteccion+"','";
                    strSqlStmt += altitud+"')";
                    
                    // Ejecuta la Sentencia
                    if (oConn.FnBoolQueryExecuteUpdate(strSqlStmt)){
                        bResult = true;
                         
                    }
            try {
                oConn.sqlStmt.close();
            } catch (SQLException ex) {
                Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
            }
             }
         }
         return bResult;
    }
    private void eliminaHist_detalle() {
        String strSqlStmt;
        strSqlStmt="DELETE  from historia_oc_detalle where cod_ho='"+txtCod_ho.getText()+"'";
        oConn.FnBoolQueryExecute(strSqlStmt);        
        
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.toedter.calendar.JDateChooser FechaHistoria;
    private javax.swing.ButtonGroup bpareaEmpresa;
    private javax.swing.ButtonGroup btActividad;
    private javax.swing.JLabel btnAdd;
    private javax.swing.JLabel btnAddAreaTrabajo;
    private javax.swing.JButton btnAgregar;
    private javax.swing.JButton btnAgregarRegistros;
    private javax.swing.JButton btnEditar;
    private javax.swing.JMenuItem btnEliminar;
    private javax.swing.JButton btnLimpiar;
    private javax.swing.ButtonGroup btngRiesgo;
    private javax.swing.JLabel btnimp;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox cboAreaTrabajo;
    private javax.swing.JCheckBox chkAct1;
    private javax.swing.JCheckBox chkAct10;
    private javax.swing.JCheckBox chkAct2;
    private javax.swing.JCheckBox chkAct3;
    private javax.swing.JCheckBox chkAct4;
    private javax.swing.JCheckBox chkAct5;
    private javax.swing.JCheckBox chkAct6;
    private javax.swing.JCheckBox chkAct7;
    private javax.swing.JCheckBox chkAct8;
    private javax.swing.JCheckBox chkAct9;
    private javax.swing.JCheckBox chkAreaEmpresa;
    private javax.swing.JCheckBox chkAreaEmpresa1;
    private javax.swing.JCheckBox chkAreaEmpresa10;
    private javax.swing.JCheckBox chkAreaEmpresa11;
    private javax.swing.JCheckBox chkAreaEmpresa12;
    private javax.swing.JCheckBox chkAreaEmpresa13;
    private javax.swing.JCheckBox chkAreaEmpresa14;
    private javax.swing.JCheckBox chkAreaEmpresa2;
    private javax.swing.JCheckBox chkAreaEmpresa3;
    private javax.swing.JCheckBox chkAreaEmpresa4;
    private javax.swing.JCheckBox chkAreaEmpresa5;
    private javax.swing.JCheckBox chkAreaEmpresa6;
    private javax.swing.JCheckBox chkAreaEmpresa7;
    private javax.swing.JCheckBox chkAreaEmpresa8;
    private javax.swing.JCheckBox chkAreaEmpresa9;
    private javax.swing.JCheckBox chkEmpresa1;
    private javax.swing.JCheckBox chkEmpresa10;
    private javax.swing.JCheckBox chkEmpresa11;
    private javax.swing.JCheckBox chkEmpresa12;
    private javax.swing.JCheckBox chkEmpresa2;
    private javax.swing.JCheckBox chkEmpresa3;
    private javax.swing.JCheckBox chkEmpresa4;
    private javax.swing.JCheckBox chkEmpresa5;
    private javax.swing.JCheckBox chkEmpresa6;
    private javax.swing.JCheckBox chkEmpresa7;
    private javax.swing.JCheckBox chkEmpresa8;
    private javax.swing.JCheckBox chkEmpresa9;
    private javax.swing.JCheckBox chkLugar;
    private javax.swing.JCheckBox chkLugar1;
    private javax.swing.JCheckBox chkLugar10;
    private javax.swing.JCheckBox chkLugar2;
    private javax.swing.JCheckBox chkLugar3;
    private javax.swing.JCheckBox chkLugar4;
    private javax.swing.JCheckBox chkLugar5;
    private javax.swing.JCheckBox chkLugar6;
    private javax.swing.JCheckBox chkLugar7;
    private javax.swing.JCheckBox chkLugar8;
    private javax.swing.JCheckBox chkLugar9;
    private javax.swing.JCheckBox chkProt1;
    private javax.swing.JCheckBox chkProt2;
    private javax.swing.JCheckBox chkProt3;
    private javax.swing.JCheckBox chkProt4;
    private javax.swing.JCheckBox chkProt5;
    private javax.swing.JCheckBox chkProt6;
    private javax.swing.JCheckBox chkRies1;
    private javax.swing.JCheckBox chkRies2;
    private javax.swing.JCheckBox chkRies3;
    private javax.swing.JCheckBox chkRies4;
    private javax.swing.JCheckBox chkRies5;
    private javax.swing.JCheckBox chkRies6;
    private javax.swing.JCheckBox chkRies7;
    private javax.swing.Box.Filler filler1;
    private javax.swing.ButtonGroup gpEmpresa;
    private javax.swing.ButtonGroup gpLugar;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JSeparator jSeparator5;
    private javax.swing.JSeparator jSeparator6;
    private javax.swing.JPopupMenu pHO;
    private javax.swing.JTable tbHT;
    private javax.swing.JTextField txtActividad;
    private javax.swing.JTextField txtAltitud;
    private javax.swing.JTextField txtAreaEmpresa;
    private javax.swing.JTextField txtCod_ho;
    private javax.swing.JTextField txtDni;
    private javax.swing.JTextField txtEmpresa;
    private javax.swing.JTextField txtFecha;
    private javax.swing.JTextField txtNombreUsuario;
    private javax.swing.JTextField txtNombres;
    private javax.swing.JTextField txtNorden;
    private javax.swing.JTextField txtOcupacion;
    private javax.swing.JTextField txtProteccion;
    private javax.swing.JTextField txtRiesgo;
    private javax.swing.JTextField txtSocavon;
    private javax.swing.JTextField txtSuperficie;
    private javax.swing.JTextField txtdni_pa;
    private javax.swing.JTextField txtimp;
    // End of variables declaration//GEN-END:variables
public void CargarAreaOcupacional(){
        cboAreaTrabajo.removeAllItems();
      String sQuery;        
        // Prepara el Query
        sQuery ="SELECT area_o FROM area_ocupacional";
        
        if (oConn.FnBoolQueryExecute(sQuery))
        {
            try 
            {
                
                 while (oConn.setResult.next())
                 {                     
                 cboAreaTrabajo.addItem(oConn.setResult.getString ("area_o"));
                     
                 }
                 
                 // Cierra Resultados
                 oConn.setResult.close();
            } 
            catch (SQLException ex) 
            {
                //JOptionPane.showMessageDialorootPane,ex);
                oFunc.SubSistemaMensajeError(ex.toString());
                
                
            }
        }
        try {
            oConn.sqlStmt.close();
        } catch (SQLException ex) {
            Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
        }
}

void sbCargarDatosHisOcupacional(){
        
          String [] titulos={"Fecha","Empresa","Altitud","Actividad","Área Empresa","Ocupación","Superficie","Socavón","Riesgo","M.Protección"};
          model = new DefaultTableModel(null,titulos);
          tbHT.setFont(new java.awt.Font("Tahoma", 0, 11)); 
          tbHT.setModel(model);
}
//void sbCargarDatosOcupacional(String valor){
//    String [] titulos={"Fecha","Empresa","Actividad","Área Empresa","Ocupación","Superficie","Socavón","Riesgo","M.Protección"};
//    String [] registros = new String[9];
//    String sql="SELECT hd.cod_ho, hd.fecha, hd.empresa, hd.actividad, hd.area_empresa, hd.ocupacion, hd.superficie, \n" +
//        "       hd.socavon, hd.riesgo, hd.proteccion\n" +
//        "  FROM datos_paciente as dp  \n" +
//        "  inner join n_orden_ocupacional AS n ON(dp.cod_pa = n.cod_pa) \n" +
//        "  inner join historia_oc_info as hi on(n.n_orden=hi.n_orden)\n" +
//        "  inner join historia_oc_detalle as hd on(hi.cod_ho=hd.cod_ho)\n" +
//        "  where n.cod_pa='"+valor+"'";
//      model = new DefaultTableModel(null,titulos){        
//              @Override
//          public boolean isCellEditable(int rowIndex, int columnIndex) {
//        return false;
//    }};
//       SimpleDateFormat formato = new SimpleDateFormat("dd/MM/yyyy");
//    if (oConn.FnBoolQueryExecute(sql))
//        {
//             try  {
//                
//                while (oConn.setResult.next())
//                {        
//                    registros[0]= oConn.setResult.getString("fecha");
//                    registros[1]= oConn.setResult.getString("empresa");
//                    registros[2]= oConn.setResult.getString("actividad");
//                    registros[3]= oConn.setResult.getString("area_empresa");
//                    registros[4]= oConn.setResult.getString("ocupacion");
//                    registros[5]= oConn.setResult.getString("superficie");
//                    registros[6]= oConn.setResult.getString("socavon");
//                    registros[7]= oConn.setResult.getString("riesgo");   
//                    registros[8]= oConn.setResult.getString("proteccion");
//                   
//                    
//                     model.addRow(registros);
//                }
//                  // Coloca el Modelo de Nueva Cuenta
//                  tbHT.setModel(model);
//                 
//                 // Cierra Resultados
//                 oConn.setResult.close();
//            } 
//            catch (SQLException ex) 
//            {
//                //JOptionPane.showMessageDialorootPane,ex);
//                oFunc.SubSistemaMensajeError(ex.toString());
//                Logger.getLogger(FichaTriaje.class.getName()).log(Level.SEVERE, null, ex);
//            }
//        }
//}
void AddHO(){
    
   
    String [] registros = new String[10];
    model = (DefaultTableModel) tbHT.getModel();
    if(!txtNorden.getText().isEmpty()){
                   if(validar()){  
                    registros[0]= txtFecha.getText().toString();
                    registros[1]= txtEmpresa.getText().toString();
                    registros[2]= txtAltitud.getText().toString();
                    registros[3]= txtActividad.getText().toString();
                    registros[4]= txtAreaEmpresa.getText().toString();
                    registros[5]= txtOcupacion.getText().toString();
                    registros[6]= txtSuperficie.getText().toString();
                    registros[7]= txtSocavon.getText().toString();
                    if(!txtRiesgo.getText().isEmpty()){
                    registros[8]= txtRiesgo.getText().toString();                    
                    }else{registros[8]= "N.A";}
                    if(!txtProteccion.getText().isEmpty()){
                    registros[9]= txtProteccion.getText().toString();
                    }else{registros[9]= "N.A";}
                model.addRow(registros);  
                tbHT.setModel(model);
                limpiar2();
                        }
                 }
       
                else{oFunc.SubSistemaMensajeError("Falto Llenar algo");
                          
                 //}
                   
            } 
        
}
        
private boolean validar(){
boolean bResultado=true;
    if(txtNorden.getText().isEmpty()){bResultado = false;}
    //if(txtFecha.getText().isEmpty()){bResultado = false;}
    if (((JTextField)FechaHistoria.getDateEditor().getUiComponent()).getText().trim().length()< 2 ) 
    {oFunc.SubSistemaMensajeError("Ingrese Fecha ");bResultado = false;}
    //if(txtEmpresa.getText().isEmpty()){bResultado = false;}
    //if(txtActividad.getText().isEmpty()){bResultado = false;}
    //if(txtAreaEmpresa.getText().isEmpty()){bResultado = false;}
    //if(txtOcupacion.getText().isEmpty()){bResultado = false;}
    //if(txtSuperficie.getText().isEmpty()){bResultado = false;}
    //if(txtSocavon.getText().isEmpty()){bResultado = false;}
   // if(txtRiesgo.getText().isEmpty()){bResultado = false;}
   // if(txtProteccion.getText().isEmpty()){bResultado = false;}
   return bResultado;
}
public void limpiar(){
  
txtNorden.setEditable(true);    
txtNorden.setText(null);
txtNombres.setText(null);
cboAreaTrabajo.setSelectedIndex(-1);
txtFecha.setText(null);
txtEmpresa.setText(null);
txtAltitud.setText(null);
txtAreaEmpresa.setText(null);
txtOcupacion.setText(null);
txtSuperficie.setText("0");
txtSocavon.setText("0");
txtRiesgo.setText(null);
txtProteccion.setText(null);
FechaHistoria.setDate(null);
FechaHistoria.setDate(null);
num=null;
  habilitar(false);
sbCargarDatosHisOcupacional();
txtNorden.requestFocus();
}
    public boolean OrdenExiste()
    {
        
        boolean bResultado=false;
        if(!txtNorden.getText().isEmpty()){
        String sQuery;

        sQuery  = "Select n_orden from historia_oc_info Where n_orden ="+txtNorden.getText().toString();
        
        //Ejecuta el Query
        oConn.FnBoolQueryExecute(sQuery);
        
        // Capturo el Error
        try {
            
            // Verifico que haya habido resultados
            if (oConn.setResult.next())
            {
                // Resultado
                bResultado = true;
             //oFunc.SubSistemaMensajeError("Número de Orden Utilizado");
             
                //limpiar();
                llenarJtable();
            }
            
            // Cierro los Resultados
            oConn.sqlStmt.close();
            
        } catch (SQLException ex) {
         
        }
        }else {oFunc.SubSistemaMensajeError("Ingrese N°Orden");}       
        return bResultado;
        
    
        }
 
public void habilitar(boolean ficha){
    
    FechaHistoria.setEnabled(ficha);
    cboAreaTrabajo.setEnabled(ficha);
    txtEmpresa.setEnabled(ficha);            
    txtFecha.setEnabled(ficha);
    txtAltitud.setEnabled(ficha);
    txtActividad.setEnabled(ficha);
    txtAreaEmpresa.setEnabled(ficha);
    txtOcupacion.setEnabled(ficha);
    txtSuperficie.setEnabled(ficha);
    txtSocavon.setEnabled(ficha);
    txtRiesgo.setEnabled(ficha);
    txtProteccion.setEnabled(ficha);
    
}
 private void imprimir(){
int seleccion = JOptionPane.showOptionDialog(
    this, // Componente padre
    "¿Desea Imprimir Historia Ocupacional ?", //Mensaje
    "Seleccione una opción", // Título
    JOptionPane.YES_NO_CANCEL_OPTION,
    JOptionPane.QUESTION_MESSAGE,
    null,    // null para icono por defecto.
    new Object[] { "Si", "No"},    // null para YES, NO y CANCEL
    "Si");
    if (seleccion != -1)
    {
   if((seleccion + 1)==1)
   {
      printer(Integer.valueOf(txtNorden.getText()));
   }
   else
   {
      // PRESIONO NO
     }
    }

}
  void Fecha(){
Date fechaDate = new Date();
//SimpleDateFormat formateador = new SimpleDateFormat("'HUAMACHUCO - ' EEEEE dd MMMMM yyyy");
FechaHistoria.setDate(fechaDate);
}
private void printer(Integer cod){
                 Map parameters = new HashMap(); 
                parameters.put("id",cod);      
                 try 
                {
                    String master = System.getProperty("user.dir") +
                                "/reportes/HistoriaOcupacional.jasper";
            
            System.out.println("master" + master);
            if (master == null) 
            {                
                System.out.println("No encuentro el archivo del reporte Historia Ocupacional.");
                //System.exit(2);
            } 
            JasperReport masterReport = null;
            try 
            {
                masterReport = (JasperReport) JRLoader.loadObject(master);
            } 
            catch (JRException e) 
            {
                System.out.println("Error cargando el reporte maestro: " + e.getMessage());
                System.exit(3);
            } 
            //JasperPrint myPrint = JasperFillManager.fillReport(masterReport,parameters,clsConnection.oConnection);
                           
              //      JasperViewer.viewReport(myPrint,false);
            
            JasperPrint jasperPrint= JasperFillManager.fillReport(masterReport,parameters,clsConnection.oConnection);
            JasperPrintManager.printReport(jasperPrint,true);

                   } catch (JRException ex) {
                    Logger.getLogger(RegistrarCliente.class.getName()).log(Level.SEVERE, null, ex);
                }
        
 
 }
private void print(Integer cod){
  //Integer n;
               //n = Integer.parseInt(txtNorden.getText());
                //Pasamos parametros al reporte Jasper. 
                Map parameters = new HashMap(); 

                // Coloco los valores en los parámetros
                parameters.put("id",cod);             
                

                try 
                {
                    String master = System.getProperty("user.dir") +
                                "/reportes/HistoriaOcupacional.jasper";
            
            System.out.println("master" + master);
            if (master == null) 
            {                
                System.out.println("No encuentro el archivo del reporte Historia Ocupacional.");
                //System.exit(2);
            } 

            JasperReport masterReport = null;
            try 
            {
                masterReport = (JasperReport) JRLoader.loadObject(master);
            } 
            catch (JRException e) 
            {
                System.out.println("Error cargando el reporte maestro: " + e.getMessage());
                System.exit(3);
            }        
                 
                    // Genera el reporte usando el objeto JasperReport e indicando la conexion
                    JasperPrint myPrint = JasperFillManager.fillReport(masterReport,parameters,clsConnection.oConnection);
                    //JasperPrint myPrint = JasperFillManager.fillReport(myReport, null,new JREmptyDataSource());

                    // Visualiza el Reporte
                  
                    JasperViewer.viewReport(myPrint,false);
                    

                } catch (JRException ex) {
                    Logger.getLogger(RegistrarCliente.class.getName()).log(Level.SEVERE, null, ex);
                }
        
 
 }
public final String[]getRowsToVector(String sql)
    {
        
        String[]veDats;
        //clsConnection oConn = new clsConnection();
        try
        {
            //oConn.FnBoolConnectionOpen(strConnector, strHost,strUser,strPassword);
            oConn.FnBoolQueryExecute(sql);

            ArrayList lista = new ArrayList();
            while (oConn.setResult.next())
            {
                lista.add(oConn.setResult.getString(1));
            }
            veDats = new String[lista.size()];
            for (int i = 0; i < lista.size(); i++)
            {
                veDats[i]=lista.get(i).toString();
            }
            oConn.sqlStmt.close();
        } catch (SQLException ex)
        {
            JOptionPane.showMessageDialog(null, "Ocurrio un error");
            
            return null;
        }
        return veDats;
    }

public static int getPosicionVectorBuscar(String datoBuscar, String[]empresas)
{
  try{
      for(int i =0;1 < empresas.length; i++){
        if(datoBuscar.equals(empresas[i].substring(0, datoBuscar.length())))
            return i;
      }
              
     
  }catch(Exception e){
  
  }
  return -1;
}
public static String getTextoApartirVector(String datoBuscar, String[]vector)
{
    int nroPosicion = getPosicionVectorBuscar(datoBuscar, vector);
    if(nroPosicion == -1){
        return datoBuscar;
    }
    return vector[nroPosicion];
}
public static void addTextAndSelectToTextFieldToRest(JTextField textField, String newDato)
{
    String datoBuscado ="";
    int nroActual = textField.getText().length();
    datoBuscado = newDato.substring(nroActual, newDato.length());
    if(newDato.isEmpty() || datoBuscado.isEmpty())
        return;
    try {
        textField.getDocument().insertString(textField.getCaretPosition(), datoBuscado, null);
    }catch(Exception e){
    }
    textField.select(nroActual, textField.getText().length());
}
 private void detallehistoria(){
     
//    String [] titulos={"N°Orden","Hospital","Operacion","Dias","complicaciones","Fecha"};
    String [] registros = new String[10];
    String sql = "SELECT fecha, empresa, actividad, area_empresa, ocupacion, superficie, \n" +
                    "       socavon, riesgo, proteccion,altitud \n" +
                    "  FROM historia_oc_detalle "
               + "WHERE cod_ho ='" + cod_ho + "'order by fecha asc ";
    if (oConn.FnBoolQueryExecute(sql))
        {
             try  {
                while (oConn.setResult.next())
                {        
                    registros[0]= oConn.setResult.getString("fecha");
                    registros[1]= oConn.setResult.getString("empresa");
                    registros[2]= oConn.setResult.getString("altitud");
                    registros[3]= oConn.setResult.getString("actividad");
                    registros[4]= oConn.setResult.getString("area_empresa");
                    registros[5]=oConn.setResult.getString("ocupacion");
                    registros[6]=oConn.setResult.getString("superficie");
                    registros[7]=oConn.setResult.getString("socavon");
                    registros[8]=oConn.setResult.getString("riesgo");
                    registros[9]=oConn.setResult.getString("proteccion");
                     model.addRow(registros);
                }
                  // Coloca el Modelo de Nueva Cuenta
                  tbHT.setModel(model);
                 // Cierra Resultados
                 oConn.setResult.close();
            } 
            catch (SQLException ex) 
            {
                //JOptionPane.showMessageDialorootPane,ex);
                oFunc.SubSistemaMensajeError(ex.toString());
                Logger.getLogger(FichaTriaje.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        try {
            oConn.sqlStmt.close();
        } catch (SQLException ex) {
            Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
        }
  }
   private boolean ActualizaHOInfo() throws SQLException{
        boolean bResult = false;
             String values ="UPDATE historia_oc_info  SET area_o='"+cboAreaTrabajo.getSelectedItem().toString()+"',"
                     + "fecha_ho='"+FechaHistoria.getDate()+"',";
                    if(tbHT.getRowCount()< 1){
                    values +="na='NA',";
                    }
                    values+="dni_user='"+txtDni.getText().toString()+"'";          
                    values+=",dni_pa='"+txtdni_pa.getText().toString()+"' where n_orden='"+txtNorden.getText()+"' RETURNING cod_ho;";      
               if (oConn.FnBoolQueryExecute(values)){
                 // num = Statement.RETURN_GENERATED_KEYS;
                   oConn.setResult.next();
                   num = oConn.setResult.getString("cod_ho");  
                   bResult = true;
                   oConn.setResult.close();
               }          
                else{
             oFunc.SubSistemaMensajeError("No se pudo registrar La Entrada");}
               
               oConn.sqlStmt.close();
                  return bResult;     
        }
    
   public void cerrarVentana(){
        // JOptionPane.showMessageDialog(null, "probando para cerrar el stament");
        System.out.println("cerro esta ventana");
        try {
            oConn.sqlStmt.close();
        } catch (SQLException ex) {
            Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
        }
  
    this.dispose();
      //  System.exit(0);

    }

    private boolean ActualizarHODetalle()
    {
         boolean bResult = false;
             String strSqlStmt;          
        // Variable para las filas de la Tabla de Productos
         if(tbHT.getRowCount()< 1){
             strSqlStmt="UPDATE historia_oc_detalle SET cod_ho='"+num+"'";
             if (oConn.FnBoolQueryExecuteUpdate(strSqlStmt)){
                  bResult = true;     
                }
         }else{    
            int iFila;
            // Variables para los diferentes datos
            String fecha, empresa, actividad, area, ocupacion, superficie, socavon, riesgo, proteccion,altitud;
            // Para la sentencia Sql
            // Para el Query
            // Ciclo para grabar el detalle de la venta
            for(iFila = 0; iFila < tbHT.getRowCount();iFila++)
            {
                //Obtiene dato contenido en una celda de la tabla
                fecha = tbHT.getModel().getValueAt(iFila, 0).toString();
                empresa = tbHT.getModel().getValueAt(iFila, 1).toString();
                altitud=tbHT.getModel().getValueAt(iFila, 2).toString();
                actividad = tbHT.getModel().getValueAt(iFila, 3).toString();
                area = tbHT.getModel().getValueAt(iFila, 4).toString();
                ocupacion = tbHT.getModel().getValueAt(iFila, 5).toString();
                superficie = tbHT.getModel().getValueAt(iFila, 6).toString(); 
                socavon = tbHT.getModel().getValueAt(iFila, 7).toString(); 
                riesgo = tbHT.getModel().getValueAt(iFila, 8).toString(); 
                proteccion = tbHT.getModel().getValueAt(iFila, 9).toString(); 
                
               strSqlStmt="UPDATE historia_oc_detalle SET fecha='"+fecha+"', "
                       + "empresa='"+empresa+"', actividad='"+actividad+"', "
                       + "area_empresa='"+area+"', ocupacion='"+ocupacion+"', "
                       + "superficie='"+superficie+"',socavon='"+socavon+"',"
                       + " riesgo='"+riesgo+"', proteccion='"+proteccion+"',altitud='"+altitud+"'";
                       strSqlStmt+="where cod_ho='"+num+"'";
                        // Ejecuta la Sentencia
                        if (oConn.FnBoolQueryExecuteUpdate(strSqlStmt)){
                            bResult = true;
                        }
                try {
                    oConn.sqlStmt.close();
                } catch (SQLException ex) {
                    Logger.getLogger(EmpresasLugaresGeograficos.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
         }
         return bResult;
    }   

}
