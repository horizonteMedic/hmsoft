<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReporteFechasTicket" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="efd5cab7-51fb-4a37-b219-346d57bcaacb">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="80"/>
	<style name="style1">
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($F{modo_pago}=="CONTADO")]]></conditionExpression>
			<style forecolor="#33CC00"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($F{modo_pago}=="CREDITO")]]></conditionExpression>
			<style forecolor="#CC0000"/>
		</conditionalStyle>
	</style>
	<parameter name="Fecha1" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="Fecha2" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT to_char(t.n_ticket,'0000000')AS numero,t.n_ticket, t.nom_medico, t.total::numeric,t.descuento::numeric,t.modo_pago,t.operador,t.h_ticket,
 t.f_ticket, d.nombres_pa||' ' ||d.apellidos_pa as nombres,t.autoriza,t.cod_vendedor,
cast((sum(tc.p_unitario)-sum(tc.p_total/tc.p_cantidad)+t.descuento) as numeric) as descuento1
FROM ticket AS t
INNER JOIN datos_paciente_asistencial AS d ON (d.cod_pa = t.cod_pa)
INNER JOIN ticket_contenido AS tc ON (tc.n_ticket= t.n_ticket)

WHERE
    t.f_ticket >= $P{Fecha1}
AND
    t.f_ticket <= $P{Fecha2}
group by t.n_ticket,t.nom_medico, t.total,t.descuento,t.f_ticket,nombres,modo_pago,t.operador,t.h_ticket,t.autoriza,t.cod_vendedor
order by numero]]>
	</queryString>
	<field name="numero" class="java.lang.String"/>
	<field name="n_ticket" class="java.lang.Integer"/>
	<field name="nom_medico" class="java.lang.String"/>
	<field name="total" class="java.math.BigDecimal"/>
	<field name="descuento" class="java.math.BigDecimal"/>
	<field name="modo_pago" class="java.lang.String"/>
	<field name="operador" class="java.lang.String"/>
	<field name="h_ticket" class="java.sql.Time"/>
	<field name="f_ticket" class="java.sql.Date"/>
	<field name="nombres" class="java.lang.String"/>
	<field name="autoriza" class="java.lang.String"/>
	<field name="cod_vendedor" class="java.lang.Integer"/>
	<field name="descuento1" class="java.math.BigDecimal"/>
	<variable name="TotalReporte" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{total}]]></variableExpression>
	</variable>
	<variable name="TotalDescuento" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{descuento}]]></variableExpression>
	</variable>
	<variable name="TotalTicket" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{n_ticket}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="85" splitType="Stretch">
			<image>
				<reportElement uuid="35ac554b-e0c3-4915-b049-dae53c07b691" x="0" y="0" width="224" height="84"/>
				<imageExpression><![CDATA["C:\\reportes\\Logo.jpg"]]></imageExpression>
			</image>
			<staticText>
				<reportElement uuid="5f564673-70ba-417d-9f2e-d536e49e01d6" x="276" y="10" width="213" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Jr. Leoncio Prado N° 786 - Huamachuco]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="86167a86-91e7-4616-b150-82aa079ff337" x="276" y="44" width="258" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Email: admision@horizontemedic.com / web: www.horizontemedic.com]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="86167a86-91e7-4616-b150-82aa079ff337" x="276" y="33" width="213" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Sánchez Carrión - La Libertad]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="de8fca2f-252f-4487-b80a-5ccf8b1af78e" x="276" y="22" width="213" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Telefono :  044-348070 / CEL. 969603777]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="18" splitType="Stretch">
			<staticText>
				<reportElement uuid="b99de470-1eb9-415a-b9d0-c809f9fd2ad3" x="36" y="0" width="393" height="16"/>
				<textElement textAlignment="Center">
					<font size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[REPORTE DE ATENCIÓN Y SERVICIOS POR TICKET]]></text>
			</staticText>
			<textField>
				<reportElement uuid="3aa1bb25-5426-4b68-bbe6-47afdcf57580" x="506" y="0" width="47" height="16"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="287ed06a-97ca-466e-95ed-1808488f1e91" x="429" y="0" width="77" height="16"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[Pagina N°]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="23" splitType="Stretch">
			<rectangle>
				<reportElement uuid="43fc1934-b35a-4b4e-953f-a7ee18cf4f07" x="0" y="3" width="555" height="20" backcolor="#CCCCCC"/>
				<graphicElement>
					<pen lineColor="#999999"/>
				</graphicElement>
			</rectangle>
			<staticText>
				<reportElement uuid="b2019896-1185-478a-a7e3-af78d25b51b8" x="7" y="8" width="52" height="11" forecolor="#0000CC"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[NRO TICKET]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="933161d8-4755-4b39-bb5a-3af5e3906c1d" x="311" y="8" width="39" height="11" forecolor="#0000CC"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[MEDICO]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="4f9d235c-23ed-43b0-9c31-a0dd2e0c19a0" x="488" y="8" width="64" height="11" forecolor="#0000CC"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[MONTO TOTAL]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="b86bbcf5-98b6-4f06-a63b-d128f5158c7c" x="379" y="8" width="55" height="11" forecolor="#0000CC"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[MODO PAGO]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="14ad1545-54f8-407f-a612-93a83a0fe334" x="230" y="8" width="34" height="11" forecolor="#0000CC"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="11ca8716-1a30-45b7-81bb-698599c6c299" x="62" y="8" width="40" height="11" forecolor="#0000CC"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[HORA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="933161d8-4755-4b39-bb5a-3af5e3906c1d" x="142" y="8" width="40" height="11" forecolor="#0000CC"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[CLIENTE]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="898c33b6-21a1-4983-ae04-f913932e8688" x="438" y="8" width="48" height="11" forecolor="#0000CC"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[AUTORIZA]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="11" splitType="Stretch">
			<textField pattern="####">
				<reportElement uuid="41eda9b2-263f-44f8-952b-99741d389901" x="1" y="0" width="58" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numero}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="8f3d2657-484f-44e7-92eb-edeaab0c5e90" x="108" y="0" width="110" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="6" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombres}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="68e2b223-634c-4b1e-97b8-be3dd202cc61" x="219" y="0" width="57" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{f_ticket}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="d1c31574-1b70-4061-b776-8721476244f3" x="278" y="0" width="98" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="5" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nom_medico}]]></textFieldExpression>
			</textField>
			<textField pattern="&apos;S/.&apos; #,##0.00">
				<reportElement uuid="b5c51ebc-e5bc-41b3-b3d3-9b137c7ec70f" style="style1" x="489" y="0" width="64" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
			<textField pattern="h:mm a">
				<reportElement uuid="6f70c377-d27a-4d0a-8288-5ce9ba40b435" x="60" y="0" width="48" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{h_ticket}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="67083369-d59b-401a-85ef-e50e82d7e9f7" style="style1" x="377" y="0" width="60" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="6" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{modo_pago}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="26cb2cad-5cae-42bf-b271-1989dcb1d6f2" x="438" y="0" width="51" height="11"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{autoriza}.equals("CREDITO")?$F{autoriza}:"N/A"]]></textFieldExpression>
			</textField>
		</band>
		<band height="21">
			<subreport>
				<reportElement uuid="4085d1e3-c9ff-4775-91bb-681cb0f406f8" x="1" y="0" width="554" height="20"/>
				<subreportParameter name="Norden">
					<subreportParameterExpression><![CDATA[$F{n_ticket}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["C:\\reportes\\ticket_subreport.jasper"]]></subreportExpression>
			</subreport>
			<line>
				<reportElement uuid="e0fd9056-14af-4578-97b8-dc6005d97ef5" x="155" y="0" width="400" height="1"/>
			</line>
		</band>
		<band height="29">
			<line>
				<reportElement uuid="1b5252ec-80fd-4709-a1ed-ed7bb71c6820" x="1" y="25" width="555" height="1" forecolor="#330099"/>
				<graphicElement>
					<pen lineWidth="3.0" lineStyle="Double"/>
				</graphicElement>
			</line>
			<textField pattern="&apos;S/.&apos; #,##0.00">
				<reportElement uuid="544296c8-81b6-42e5-adae-8a0bdf93729c" x="485" y="1" width="68" height="11"/>
				<textElement>
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{descuento}.equals( null )?"S/.00,00":$F{descuento}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="8d9505c7-8514-40a3-98dc-d499e9062701" x="368" y="1" width="108" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[DESCUENTO ADICIONAL]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="87286a41-e1ee-4739-a3b9-8f8c431883e0" x="384" y="12" width="92" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL A PAGAR]]></text>
			</staticText>
			<textField pattern="&apos;S/.&apos; #,##0.00">
				<reportElement uuid="f00cc86f-bec9-476e-bd50-2e6daaa2202c" x="485" y="12" width="68" height="11"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="bbfb792d-8674-4e30-a246-8e573eb95503" x="78" y="7" width="121" height="11" forecolor="#CC0000"/>
				<textElement verticalAlignment="Middle">
					<font size="5" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{operador}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="3991aba5-dcbb-4790-93de-ebaf45f3ea5a" x="199" y="7" width="93" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="5" isBold="true"/>
				</textElement>
				<text><![CDATA[CODIGO VENDEDOR:]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="99315f2e-0bfb-4ac6-baed-965ab596da3b" x="0" y="7" width="68" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="5" isBold="true"/>
				</textElement>
				<text><![CDATA[USUARIO SISTEMA:]]></text>
			</staticText>
			<textField>
				<reportElement uuid="116c44a1-0542-4c15-adc9-c09d1a68626a" x="296" y="7" width="54" height="11" forecolor="#006600"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cod_vendedor}.equals(null)?"N/A":$F{cod_vendedor}.equals("")?"N/A":$F{cod_vendedor}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="10" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="10" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="29" splitType="Stretch">
			<textField pattern="&apos;S/.&apos;#,###.00" isBlankWhenNull="true">
				<reportElement uuid="6e1f4ca1-ea76-44b6-a98e-98f7d8693bc8" x="455" y="7" width="98" height="17"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Double"/>
					<topPen lineWidth="1.0" lineStyle="Double"/>
					<leftPen lineWidth="1.0" lineStyle="Double"/>
					<bottomPen lineWidth="1.0" lineStyle="Double"/>
					<rightPen lineWidth="1.0" lineStyle="Double"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalReporte}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="fbe78a6f-4156-4c23-bd9a-f83f49fbe0e5" x="2" y="0" width="553" height="1"/>
			</line>
			<staticText>
				<reportElement uuid="04b4cd89-46db-4558-81c1-be97f6670e51" x="389" y="8" width="67" height="17"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Monto Total :]]></text>
			</staticText>
			<textField pattern="&apos;S/.&apos;#,###.00" isBlankWhenNull="true">
				<reportElement uuid="9b8ea456-510d-40e7-82a0-282d4ebb7c36" x="332" y="8" width="58" height="17"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalDescuento}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="50fb7450-3719-4c4d-8173-cdaf9b1826c3" x="265" y="8" width="67" height="17"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Desc. Total :]]></text>
			</staticText>
			<textField>
				<reportElement uuid="d1581133-21a3-427e-98c5-21e555a91daa" x="141" y="8" width="36" height="17"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalTicket}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="25d4315c-368d-4f8d-ad45-d7df46e217e7" x="46" y="8" width="95" height="17"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL TICKETS:]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
